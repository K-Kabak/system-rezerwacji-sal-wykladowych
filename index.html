<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>System Rezerwacji Sal</title>
  <link rel="icon" href="/images/favicon.png" type="image/png">
  <link rel="stylesheet" href="style.css" />
  <style>
    /* === Style Globalne === */
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #111;
      color: #fff;
      line-height: 1.6;
    }
    .hidden {
      display: none;
    }
    button {
        background: #3a3aff;
        color: #fff;
        border: none;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.3s ease;
        font-size: 1em;
    }
    button:hover {
        background: #5353ff;
    }
    /* === Układ Logowania === */
    #auth-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      box-sizing: border-box;
    }
    .auth-layout {
      display: flex;
      width: 100%;
      min-height: 100vh;
      background-color: #191919;
    }
    .auth-panel {
      flex: 1 1 50%; 
      display: flex; 
      flex-direction: column;
      padding: 40px 5%; 
      height: 100vh;
      overflow-y: auto;
      padding: 5px 5%;
      box-sizing: border-box;
    }
    .auth-image-panel {
      flex: 1 1 50%; 
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #0d0d0d;
      overflow: hidden;
    }
    .auth-image-panel img {
      width: 100%; 
      height: 100%;
      object-fit: cover;
    }

    /* === Logo === */
    .auth-logo-container {
        text-align: center;
        margin-bottom: 0px; 
    }
    .auth-logo-container img {
        max-width: 280px; 
        height: auto;
    }

    /* === Style Formularza === */
    .auth-container {
      width: 100%;
      max-width: 450px;
      margin: 0 auto;
      padding-bottom: 10px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .auth-container h1, .auth-container h2 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 30px;
      color: #eee;
    }
    .auth-form label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
      color: #ccc;
      font-size: 0.9em;
    }
    .auth-form input[type="text"],
    .auth-form input[type="email"],
    .auth-form input[type="password"],
    .auth-form select {
      width: 100%;
      padding: 12px;
      margin-bottom: 18px;
      border: 1px solid #555;
      border-radius: 5px;
      background-color: #2a2a2a;
      color: #fff;
      box-sizing: border-box;
      font-size: 1em;
    }
    .auth-form input:focus, .auth-form select:focus {
        outline: none;
        border-color: #3a3aff;
        box-shadow: 0 0 5px rgba(58, 58, 255, 0.5);
    }
    .auth-form button {
      width: 100%;
      padding: 14px;
      margin-top: 10px;
      font-size: 1.1em;
    }
    .auth-toggle-link {
      display: block;
      text-align: center;
      margin-top: 25px;
      color: #888;
      cursor: pointer;
      text-decoration: none;
      font-size: 0.9em;
    }
    .auth-toggle-link:hover {
      color: #ccc;
      text-decoration: underline;
    }
    .error-message, .success-message {
      margin-top: 15px;
      text-align: center;
      min-height: 1.2em; 
      font-size: 0.9em;
    }
    .error-message {
      color: #ff8080;
    }
    .success-message {
      color: #80ff80; 
    }
    .role-specific-fields {
        border-left: 3px solid #3a3aff;
        padding-left: 15px;
        margin-left: 0;
        margin-bottom: 20px;
        display: none;
    }
    .role-specific-fields.visible {
        display: block;
    }

    /* === Responsywność === */
    @media (max-width: 800px) { /* Zmieniony punkt responsywności */
      .auth-layout {
        flex-direction: column;
      }
      .auth-image-panel {
        /* Ukryj obrazek na mniejszych ekranach */
        display: none;
      }
      .auth-panel {
        flex-basis: 100%; /* Zajmuje całą szerokość */
        max-width: 450px; /* Ograniczenie szerokości formularza na mobilnych */
        padding: 30px; /* Mniejsze odstępy */
        margin-top: 30px; /* Odstęp od góry */
        margin-bottom: 30px;
      }
       #auth-wrapper {
          /* Dodajemy lekkie tło, żeby formularz się wyróżniał, jeśli body ma inne tło */
          /* background-color: #111; */
          justify-content: flex-start; /* Wyrównaj do góry */
      }
    }
      /* --- Stylizacja paska przewijania dla panelu formularza --- */

      /* Dla przeglądarek WebKit (Chrome, Safari, Edge, Opera) */
      .auth-panel::-webkit-scrollbar {
        width: 8px; /* Szerokość paska - możesz dostosować */
      }

      .auth-panel::-webkit-scrollbar-track {
        background: #1f1f1f; /* Kolor tła "ścieżki" paska - dopasowany do tła formularza */
        border-radius: 4px; /* Lekkie zaokrąglenie */
      }

      .auth-panel::-webkit-scrollbar-thumb {
        background-color: #555; /* Kolor samego "uchwytu" paska - ciemnoszary */
        border-radius: 4px; /* Zaokrąglenie uchwytu */
        /* Opcjonalnie: dodaj ramkę w kolorze tła, aby uchwyt wydawał się cieńszy */
        border: 2px solid #1f1f1f;
      }

      .auth-panel::-webkit-scrollbar-thumb:hover {
        background-color: #777; /* Kolor uchwytu po najechaniu myszką - jaśniejszy szary */
      }

      /* Dla Firefox */
      .auth-panel {
        scrollbar-width: thin; /* Ustawia cieńszy pasek w Firefox ("auto" lub "thin") */
        scrollbar-color: #555 #1f1f1f; /* Kolor uchwytu ORAZ kolor ścieżki */
      }

    /* === Style dla Dashboardu === */
    #dashboard-view {
      display: none; /* Ukryty domyślnie */
    }
    
  </style>
</head>
<body>

  <div id="auth-wrapper">
    <div class="auth-layout">
      <div class="auth-panel">
        <div class="auth-logo-container">
          <img src="images/logo_logowania.png" alt="Logo Systemu Rezerwacji"> </div>

        <div id="login-view" class="auth-container">
          <form id="login-form" class="auth-form">
            <h1>Logowanie</h1>
            <label for="login-username">Login:</label>
            <input type="text" id="login-username" name="login" required>

            <label for="login-password">Hasło:</label>
            <input type="password" id="login-password" name="haslo" required>

            <button type="submit">Zaloguj się</button>
            <p id="login-error" class="error-message"></p>
            <span class="auth-toggle-link" onclick="toggleAuthView(false)">Nie masz konta? Zarejestruj się</span>
          </form>
        </div>

        <div id="register-view" class="auth-container hidden">
          <form id="register-form" class="auth-form">
            <h2>Rejestracja</h2>

            <label for="register-login">Login:</label>
            <input type="text" id="register-login" name="login" required>

            <label for="register-imie">Imię:</label>
            <input type="text" id="register-imie" name="imie" required>

            <label for="register-nazwisko">Nazwisko:</label>
            <input type="text" id="register-nazwisko" name="nazwisko" required>

            <label for="register-email">Email:</label>
            <input type="email" id="register-email" name="email" required>

            <label for="register-password">Hasło:</label>
            <input type="password" id="register-password" name="haslo" required>

            <label for="register-rola">Rola:</label>
            <select id="register-rola" name="rola" required>
              <option value="">-- Wybierz rolę --</option>
              <option value="student">Student</option>
              <option value="wykladowca">Wykładowca</option>
            </select>

            <div id="student-fields" class="role-specific-fields">
                <label for="register-nr_indeksu">Numer indeksu:</label>
                <input type="text" id="register-nr_indeksu" name="nr_indeksu">
                <label for="register-grupa">Grupa:</label>
                <input type="text" id="register-grupa" name="grupa">
                <label for="register-kierunek">Kierunek:</label>
                <input type="text" id="register-kierunek" name="kierunek">
            </div>

            <div id="wykladowca-fields" class="role-specific-fields">
                <label for="register-tytul">Tytuł naukowy (opcjonalnie):</label>
                <input type="text" id="register-tytul" name="tytul_naukowy">
            </div>

            <button type="submit">Zarejestruj się</button>
            <p id="register-message" class="error-message"></p>
            <span class="auth-toggle-link" onclick="toggleAuthView(true)">Masz już konto? Zaloguj się</span>
          </form>
        </div>
      </div> <div class="auth-image-panel">
        <img src="images/login.png" alt="Grafika logowania - kalendarz i ludzie">
      </div>

    </div> </div> <div id="dashboard-view" class="dashboard">
      <aside class="sidebar">
          <div class="logo">
            <img src="images/logo.png" alt="Logo" />
          </div>
          <nav>
            <ul>
              <li id="nav-rezerwacje" class="active">Rezerwacje</li>
              <li id="nav-kalendarz">Kalendarz</li>
              <li id="nav-wiadomosci">Wiadomości <span class="notification-dot"></span></li>

            </ul>
          </nav>
          <div class="legend" id="legend">
            <p><span class="dot blue"></span> Aula</p>
            <p><span class="dot violet"></span> Sala wykładowa</p>
            <p><span class="dot red"></span> Laboratorium</p>
          </div>
          <div class="user-info" style="margin-top: 20px; font-size: 14px; border-top: 1px solid #333; padding-top: 10px;">
              <p>Zalogowano jako:</p>
              <p id="user-details" style="font-weight: bold;">...</p>
          </div>
          <div class="bottom-menu">
            <p>⚙️ Ustawienia</p>
            <p><button id="btn-logout" style="background: #555; padding: 8px 15px; width: auto;">🚪 Wyloguj</button></p>
          </div>
        </aside>
        <!--Rezerwacje sal-->
        <main class="main-content" id="view-rezerwacje">
          <h2>Rezerwacje sal</h2>
          <table>
            <thead>
              <tr>
                <th>Numer sali</th>
                <th>Ilość miejsc</th>
                <th>Typ</th>
                <th>Grupa</th>
                <th>Data</th>
                <th>Godz. od</th>
                <th>Godz. do</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="roomTable"></tbody>
          </table>
           <p id="booking-error" class="error-message"></p>
        </main>

        <main class="main-content hidden" id="view-kalendarz">
          <div class="calendar-header">
            <button id="prevMonth">&#8592;</button>
            <h2 id="monthTitle"></h2>
            <button id="nextMonth">&#8594;</button>
          </div>
          <div class="calendar-days" id="calendarDays"></div>
          <div class="calendar" id="calendarGrid"></div>
        </main>
        <!--Wiadmości-->
        <section class="main-content hidden" id="view-wiadomosci">
          <h2>Wiadomości</h2>
          <div style="display: flex; gap: 30px;">
            
            <!-- Lewa strona – formularz -->
            <div style="flex: 1;">
              <h3>Wyślij wiadomość</h3>
              <form id="message-form">
                <label for="msg-to">Do (email):</label>
                <input type="email" id="msg-to" name="msg-to" class="message-input" list="email-suggestions" autocomplete="off" required />
                <datalist id="email-suggestions"></datalist>

                <label for="msg-content">Treść:</label>
                <textarea id="msg-content" name="msg-content" rows="5" class="message-textarea" required></textarea>

                <button type="submit">Wyślij</button>

              </form>
              <p id="message-status"></p>
            </div>
        
            <!-- Prawa strona – otrzymane wiadomości -->
            <div style="flex: 2;">
              <h3>Otrzymane wiadomości</h3>
              <ul id="received-messages" style="list-style: none; padding-left: 0;"></ul>
            </div>
        
          </div>
        </section>
        
        <div id="day-details-modal" class="modal-overlay hidden"> <div class="modal-content">
          <span class="close-button" onclick="closeDayDetailsModal()">&times;</span>
          <h3>Szczegóły Rezerwacji - <span id="modal-date"></span></h3> <div id="modal-reservations-list"> </div>
        </div>
      </div>
      <div id="notification-modal" class="notification-overlay hidden"> <div class="notification-content">
        <span class="close-button" onclick="hideNotification()">&times;</span>
        <h4 id="notification-title">Powiadomienie</h4>
        <p id="notification-message" style="text-align: center; margin-top: 15px;"></p>
        <button onclick="hideNotification()" style="display: block; margin: 20px auto 0; min-width: 80px;">OK</button>
      </div>
    </div>
    <div id="confirm-modal" class="notification-overlay hidden">
      <div class="notification-content">
        <h4 id="confirm-title">Potwierdzenie</h4>
        <p id="confirm-message" style="text-align: center; margin-top: 15px;">Czy na pewno chcesz wykonać tę akcję?</p>
        <div style="display: flex; justify-content: center; gap: 20px; margin-top: 20px;">
          <button id="confirm-ok" style="min-width: 80px;">OK</button>
          <button id="confirm-cancel" style="min-width: 80px; background-color: gray;">Anuluj</button>
        </div>
      </div>
    </div>
    
    <script src="script.js"></script>
  </body>
  </html>